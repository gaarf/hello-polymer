<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-range-behavior/iron-range-behavior.html">
<link rel="import" href="/bower_components/paper-button/paper-button.html">

<!--
`<my-foo>` injects a healthy dose of awesome into your page.
-->
<dom-module id="my-foo">

  <style>
    :host {
      display: inline-block;
      border: 1px dotted orange;
      padding: 4px;
    }

    h6 {
      color: green;
      margin: 0;
      text-align: center;
    }

    input {
      width: 100%;
    }

    ul, li {
      margin: 0;
      padding: 0;
      list-style-type: none;
    }
    li {
      background-color: yellow;
      border: 1px dotted orange;
      font-size: 77%;
    }
  </style>

  <template>

    <h6>
      this is a &lt;my-foo&gt; element
    </h6>

    <content hidden></content>

    <p>
      <input type="range" value="{{value::change}}" min="{{min}}" max="{{max}}">
    </p>

    <ul class="layout horizontal">
      <template is="dom-repeat" items="{{items}}">
        <li class="flex">{{item}}</li>
      </template>
    </ul>

    <p>
      <em>{{value}}</em> = <span>{{ratio}}</span>%
    </p>

    <p>
      <paper-button raised on-tap="incrementCount">
        increment
      </paper-button>

      <paper-button raised on-tap="doRemoval">
        remove &lt;my-foo&gt;
      </paper-button>
      <a href="/assets/elements/my-foo/index.html">read about my-foo</a>
    </p>

  </template>

</dom-module>

<script>

  Polymer({

    is: 'my-foo',

    behaviors: [Polymer.IronRangeBehavior],

    properties: {
      /** contains as many foos as the value of the range. */
      items: {
        type: Array,
        computed: 'computeItems(value)'
      }
    },

    /**
     * Applies awesomeness to `element`.
     *
     * @param {number} level The numeric level of awesomeness. A value
     *     between `min` and `max`.
     * @return {array} The cumulative awesomeness.
     */
    computeItems: function (count) {
      var out = [],
          n = Polymer.dom(this.$$('content')).getDistributedNodes();
      for (var i = 0; i < count; i++) {
        out.push( n[i%n.length].innerText || 'foo' );
      };
      return out;
    },

    ready: function () {
      console.log(this, 'ready');
      this.value = 1;
      this.max = 20;
    },

    attached: function () {
      console.log(this, 'attached');
    },

    detached: function () {
      console.log(this, 'detached');
    },

    /**
     * increment awesomeness by one
     */
    incrementCount: function () {
      this.value++;
    },

    /**
     * commit suicide
     */
    doRemoval: function () {
      Polymer.dom(this.parentNode).removeChild(this);
    }

  });

</script>
